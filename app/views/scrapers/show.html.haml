.row
  .col-md-11
    %h1
      = link_to @scraper.owner.to_param, @scraper.owner
      \/
      = link_to @scraper.name, @scraper
  .col-md-1
    - if current_user.indirectly_watching?(@scraper)
      = button_to "Unwatch", "#", class: "btn btn-default", disabled: "disabled"
    - elsif current_user.watching?(@scraper)
      = button_to "Unwatch", scraper_watch_path(@scraper), class: "btn btn-default"
    - else
      = button_to "Watch", scraper_watch_path(@scraper), class: "btn btn-default"

%h4
  = @scraper.description
  - if @scraper.auto_run
    %i.icon-time
  - if @scraper.queued? || @scraper.running?
    .pulse

%p= @scraper.readme

- if @scraper.scraperwiki_url
  %p
    Forked from
    = link_to "ScraperWiki", @scraper.scraperwiki_url, target: "_blank"

- if @scraper.github_url
  %p
    %i.icon-github-sign.icon-large
    = link_to @scraper.github_url, target: "_blank" do
      = @scraper.name
    - if @scraper.main_scraper_filename
      (#{link_to @scraper.main_scraper_filename, @scraper.github_url_main_scraper_file, target: "_blank"}) on GitHub

- if @scraper.forking?
  %h2 Forking!
  .progress.progress-striped.active
    .progress-bar(style="width: 100%")
  %span.muted
    (Refresh page for the latest)

- else
  = render "status"
  .row
    .col-md-9
      - if @scraper.can_write?(current_user)
        %p= button_to "Run it now!", run_scraper_path(@scraper), class: (!@scraper.runnable? ? "btn btn-primary btn-lg disabled" : "btn btn-primary btn-lg"), disabled: !@scraper.runnable?

      %h3 Statistics
      - if @scraper.average_successful_wall_time
        %p
          Average successful run time:
          = "%.1f s" % @scraper.average_successful_wall_time
      %p
        Total run time:
        = "%.1f s" % @scraper.total_wall_time
      %p
        Total cpu time used:
        = "%.1f s" % @scraper.cpu_time
      %p
        Total disk space used:
        = number_to_human_size @scraper.total_disk_usage
    .col-md-3
      = render "settings"

  = render "console"
  = render "data"
  = render "history"
  = render "danger"
